
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Beamforming with moving focus &#8212; Acoular 26.01 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/sphinx_gallery.css?v=f3715e10" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_pydata_sphinx_theme.css?v=ac99e154" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=56098ba5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=30646c52"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/moving_sources_examples/example_beamforming_with_moving_focus';</script>
    <link rel="icon" href="../../_static/acoular_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Rotating point source" href="example_rotating_point_source.html" />
    <link rel="prev" title="Moving sources examples" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="26.01" />
    <meta name="docbuild:last-update" content="Feb 03, 2026"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">üëÅÔ∏èüì¢ Please consider taking the <a href='https://www.soscisurvey.de/acoularsurvey'>Acoular User Survey</a>. ‚è±Ô∏è It's only 2 minutes! ‰∏â‰∏â·ïï( ·êõ )·ïó</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/Acoular_logo.png" class="logo__image only-light" alt="Acoular - Home"/>
    <img src="../../_static/Acoular_logo.png" class="logo__image only-dark pst-js-only" alt="Acoular - Home"/>
  
  
    <p class="title logo__title">Acoular</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../install/index.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api_ref/index.html">
    API Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../news/index.html">
    What's new
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../contributing/index.html">
    Contributing
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../literature/index.html">
    Literature
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/acoular/acoular" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/acoular" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/pypi.svg" class="icon-link-image" alt="PyPI"/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../install/index.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api_ref/index.html">
    API Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../news/index.html">
    What's new
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributing/index.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../literature/index.html">
    Literature
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/acoular/acoular" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/acoular" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/pypi.svg" class="icon-link-image" alt="PyPI"/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introductory_examples/index.html">Introductory examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introductory_examples/example_three_sources.html">Three sources ‚Äì Generate synthetic microphone array data.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introductory_examples/example_basic_beamforming.html">Basic Beamforming ‚Äì Generate a map of three sources.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introductory_examples/example_3D_beamforming.html">3D Beamforming with CLEAN-SC deconvolution.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introductory_examples/example_grids.html">Grids</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../wind_tunnel_examples/index.html">Wind tunnel examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../wind_tunnel_examples/example_airfoil_in_open_jet_cmf.html">Airfoil in open jet ‚Äì Covariance matrix fitting (CMF).</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wind_tunnel_examples/example_airfoil_in_open_jet_steering_vectors.html">Airfoil in open jet ‚Äì steering vectors.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wind_tunnel_examples/example_airfoil_in_open_jet_freq_domain_methods.html">Airfoil in open jet ‚Äì Frequency domain beamforming methods.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wind_tunnel_examples/example_sectors_and_integration.html">Sector Integration Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wind_tunnel_examples/example_airfoil_in_open_jet_time_domain_methods.html">Airfoil in open jet ‚Äì Time domain beamforming methods.</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Moving sources examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Beamforming with moving focus</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_rotating_point_source.html">Rotating point source</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../io_and_signal_processing_examples/index.html">IO and signal processing examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../io_and_signal_processing_examples/example_filter.html">Show basic filtering capabilities.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io_and_signal_processing_examples/example_power_spectra_import.html">Cross-spectral matrix import</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io_and_signal_processing_examples/example_sample_splitter_multithreading.html">Parallel processing chains ‚Äì Multithreading with the SampleSplitter.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io_and_signal_processing_examples/example_sample_splitter_bufferhandling.html">Parallel processing chains ‚Äì SampleSplitter buffer handling.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io_and_signal_processing_examples/example_fft.html">Fast Fourier Transform (FFT) of multichannel time data.</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tools/index.html">Tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tools/example_tools.html">Tools ‚Äì Demonstrates barspectrum tool of Acoular</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/example_evaluate.html">Evaluate source characterization performance.</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Moving sources examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Beamforming with moving focus</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-moving-sources-examples-example-beamforming-with-moving-focus-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="beamforming-with-moving-focus">
<span id="sphx-glr-auto-examples-moving-sources-examples-example-beamforming-with-moving-focus-py"></span><span id="id1"></span><h1>Beamforming with moving focus<a class="headerlink" href="#beamforming-with-moving-focus" title="Link to this heading">#</a></h1>
<p>This example demonstrates how to use Acoular to perform moving-focus beamforming
with and without CLEANT-based deconvolution for moving sources.</p>
<p>A constellation of four moving white-noise sources passing over a microphone array
is evaluated using three different beamforming approaches:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Fixed-focus beamforming on a static grid</p></li>
<li><p>Moving-focus beamforming along a defined trajectory</p></li>
<li><p>Moving-focus beamforming along the same trajectory with CLEANT-based deconvolution</p></li>
</ol>
</div></blockquote>
<section id="setting-up-the-example">
<h2>Setting up the example<a class="headerlink" href="#setting-up-the-example" title="Link to this heading">#</a></h2>
<p>At the beginning of this example, we make the necessary imports
and define the simulation parameters.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a>

<span class="kn">import</span><span class="w"> </span><span class="nn">acoular</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ac</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
<p>We define the trajectory of the moving focus and the parameters for
the moving sources. The trajectory is a straight line along the x-axis at a
fixed height (<em>z</em> = 10 m) and <em>y</em> = 0. The sources move at a speed of 60 km/h
and pass by the array over a duration of 0.6 seconds.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LX</span></a> <span class="o">=</span> <span class="mf">5.0</span>  <span class="c1"># m, distance to start position on x-axis</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LZ</span></a> <span class="o">=</span> <span class="mf">10.0</span>  <span class="c1"># m, distance between array and source plane</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">V_KMH</span></a> <span class="o">=</span> <span class="mf">60.0</span>  <span class="c1"># km/h, source velocity</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">VX_M</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">V_KMH</span></a> <span class="o">/</span> <span class="mf">3.6</span>  <span class="c1"># m/s, source velocity converted to meters per second</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">T_PASS</span></a> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LX</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">VX_M</span></a>  <span class="c1"># s, total pass-by duration</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.trajectory.html#acoular.trajectory.Trajectory" title="acoular.trajectory.Trajectory" class="sphx-glr-backref-module-acoular-trajectory sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tr0</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.trajectory.html#acoular.trajectory.Trajectory" title="acoular.trajectory.Trajectory" class="sphx-glr-backref-module-acoular-trajectory sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">Trajectory</span></a><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LX</span></a><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LZ</span></a><span class="p">),</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">T_PASS</span></a><span class="p">:</span> <span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LX</span></a><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LZ</span></a><span class="p">)})</span>  <span class="c1"># moving focus trajectory</span>
</pre></div>
</div>
<p>Next, we define parameters for the microphone array, the processing blocks,
and the frequency band of interest.</p>
<p>The example uses a 64-microphone array.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://www.acoular.org/api_ref/generated/acoular.microphones.html#acoular.microphones.MicGeom" title="acoular.microphones.MicGeom" class="sphx-glr-backref-module-acoular-microphones sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mics</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.microphones.html#acoular.microphones.MicGeom" title="acoular.microphones.MicGeom" class="sphx-glr-backref-module-acoular-microphones sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">MicGeom</span></a><span class="p">(</span><span class="n">file</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;xml&#39;</span> <span class="o">/</span> <span class="s1">&#39;tub_vogel64.xml&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.scatter.html#matplotlib.pyplot.scatter" title="matplotlib.pyplot.scatter" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span></a><span class="p">(</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mics</span><span class="o">.</span><span class="n">pos</span></a><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_beamforming_with_moving_focus_001.png" srcset="../../_images/sphx_glr_example_beamforming_with_moving_focus_001.png" alt="example beamforming with moving focus" class = "sphx-glr-single-img"/><p>The sampling frequency is set to 6.4 kHz, and the total
number of samples is calculated based on the pass duration.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SFREQ</span></a> <span class="o">=</span> <span class="mi">6400</span>  <span class="c1"># Hz, sampling frequency</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NUM_SAMPLES</span></a> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">T_PASS</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SFREQ</span></a><span class="p">)</span>  <span class="c1"># total number of samples</span>
</pre></div>
</div>
<p>The processing block size is set to 1/4 of the total number of samples.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">BLOCK_SIZE</span></a> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NUM_SAMPLES</span></a> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># number of samples per processing block</span>
</pre></div>
</div>
<p>The frequency band of interest is set to 2000 Hz, which
corresponds to a third-octave band used for analysis.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">FREQ</span></a> <span class="o">=</span> <span class="mi">2000</span>  <span class="c1"># Hz, third-octave band used for analysis</span>
</pre></div>
</div>
<p>Beamforming will be performed using a rectangular grid in the <em>x-y</em> plane,
centered at the origin <em>(0, 0)</em> and extending from -2 to 2 meters in both <em>x</em> and <em>y</em> directions.
The grid increment is set to 0.2 meters for faster computation.</p>
<p><em>Generally, Acoular works with dimensionless units, but since we defined the
trajectory in meters above, we will use the same unit for the grid.</em></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://www.acoular.org/api_ref/generated/acoular.grids.html#acoular.grids.RectGrid" title="acoular.grids.RectGrid" class="sphx-glr-backref-module-acoular-grids sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rg</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.grids.html#acoular.grids.RectGrid" title="acoular.grids.RectGrid" class="sphx-glr-backref-module-acoular-grids sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">RectGrid</span></a><span class="p">(</span><span class="n">x_min</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_min</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_max</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
<p>The steering vector is created for the grid and the microphone array.
This vector is used to steer the beamformer towards the desired focus trajectory.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://www.acoular.org/api_ref/generated/acoular.fbeamform.html#acoular.fbeamform.SteeringVector" title="acoular.fbeamform.SteeringVector" class="sphx-glr-backref-module-acoular-fbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">st</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.fbeamform.html#acoular.fbeamform.SteeringVector" title="acoular.fbeamform.SteeringVector" class="sphx-glr-backref-module-acoular-fbeamform sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">SteeringVector</span></a><span class="p">(</span><span class="n">grid</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.grids.html#acoular.grids.RectGrid" title="acoular.grids.RectGrid" class="sphx-glr-backref-module-acoular-grids sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rg</span></a><span class="p">,</span> <a href="https://www.acoular.org/api_ref/generated/acoular.microphones.html#acoular.microphones.MicGeom" title="acoular.microphones.MicGeom" class="sphx-glr-backref-module-acoular-microphones sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mics</span></a><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.microphones.html#acoular.microphones.MicGeom" title="acoular.microphones.MicGeom" class="sphx-glr-backref-module-acoular-microphones sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mics</span></a><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../api_ref/generated/acoular.signals.html#acoular.signals.WNoiseGenerator" title="acoular.signals.WNoiseGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">WNoiseGenerator</span></code></a> is used to create white-noise signal
generators for the sources. Each source has a different root mean square (RMS) value,
which is set to 0.564 multiplied by a factor that decreases with each source.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">wngen</span><span class="p">(</span><span class="n">nseed</span><span class="p">):</span>
    <span class="n">rms</span> <span class="o">=</span> <span class="mf">0.564</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">nseed</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <a href="https://www.acoular.org/api_ref/generated/acoular.signals.html#acoular.signals.WNoiseGenerator" title="acoular.signals.WNoiseGenerator" class="sphx-glr-backref-module-acoular-signals sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">WNoiseGenerator</span></a><span class="p">(</span><span class="n">sample_freq</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SFREQ</span></a><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NUM_SAMPLES</span></a><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">nseed</span><span class="p">,</span> <span class="n">rms</span><span class="o">=</span><span class="n">rms</span><span class="p">)</span>


<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sigs</span></a> <span class="o">=</span> <span class="p">[</span><span class="n">wngen</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</pre></div>
</div>
<p>The four sources are positioned at the corners of a square spanning an area of 2 by 2 meters.
For each source position, a trajectory is created that is offset from the moving focus trajectory.
The sources move linearly along the <em>x</em>-axis, passing by the microphone array.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_pos</span></a> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">create_trajectory</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="c1"># Linear trajectory offset by source position</span>
    <span class="k">return</span> <a href="https://www.acoular.org/api_ref/generated/acoular.trajectory.html#acoular.trajectory.Trajectory" title="acoular.trajectory.Trajectory" class="sphx-glr-backref-module-acoular-trajectory sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">Trajectory</span></a><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LX</span></a> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LZ</span></a> <span class="o">+</span> <span class="n">z</span><span class="p">),</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">T_PASS</span></a><span class="p">:</span> <span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LX</span></a> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LZ</span></a> <span class="o">+</span> <span class="n">z</span><span class="p">)})</span>


<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trs</span></a> <span class="o">=</span> <span class="p">[</span><span class="n">create_trajectory</span><span class="p">(</span><span class="o">*</span><span class="n">sp</span><span class="p">)</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_pos</span></a><span class="p">]</span>
</pre></div>
</div>
<p>The sources are combined with their respective trajectories
using the <a class="reference internal" href="../../api_ref/generated/acoular.sources.html#acoular.sources.MovingPointSource" title="acoular.sources.MovingPointSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">MovingPointSource</span></code></a> class.
The <a class="reference internal" href="../../api_ref/generated/acoular.sources.html#acoular.sources.MovingPointSource.conv_amp" title="acoular.sources.MovingPointSource.conv_amp"><code class="xref py py-attr docutils literal notranslate"><span class="pre">conv_amp</span></code></a> parameter is
set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to account for amplitude changes due to distance variations.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mps</span></a> <span class="o">=</span> <span class="p">[</span>
    <a href="https://www.acoular.org/api_ref/generated/acoular.sources.html#acoular.sources.MovingPointSource" title="acoular.sources.MovingPointSource" class="sphx-glr-backref-module-acoular-sources sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">MovingPointSource</span></a><span class="p">(</span><span class="n">signal</span><span class="o">=</span><span class="n">sig</span><span class="p">,</span> <a href="https://www.acoular.org/api_ref/generated/acoular.microphones.html#acoular.microphones.MicGeom" title="acoular.microphones.MicGeom" class="sphx-glr-backref-module-acoular-microphones sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mics</span></a><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.microphones.html#acoular.microphones.MicGeom" title="acoular.microphones.MicGeom" class="sphx-glr-backref-module-acoular-microphones sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mics</span></a><span class="p">,</span> <span class="n">trajectory</span><span class="o">=</span><span class="n">tr</span><span class="p">,</span> <span class="n">conv_amp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">sig</span><span class="p">,</span> <span class="n">tr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sigs</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trs</span></a><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Finally, the sources are mixed together using the <a class="reference internal" href="../../api_ref/generated/acoular.sources.html#acoular.sources.SourceMixer" title="acoular.sources.SourceMixer"><code class="xref py py-class docutils literal notranslate"><span class="pre">SourceMixer</span></code></a> class.
This class combines the individual source signals into a single mixed signal
that can be processed further down the chain.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://www.acoular.org/api_ref/generated/acoular.sources.html#acoular.sources.SourceMixer" title="acoular.sources.SourceMixer" class="sphx-glr-backref-module-acoular-sources sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_mixer</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.sources.html#acoular.sources.SourceMixer" title="acoular.sources.SourceMixer" class="sphx-glr-backref-module-acoular-sources sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">SourceMixer</span></a><span class="p">(</span><span class="n">sources</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mps</span></a><span class="p">)</span>
</pre></div>
</div>
<p>On top of these preparations for the moving sources and trajectory,
we also define a visualization function to plot the beamforming maps.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_maps</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">figure_title</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">BLOCK_SIZE</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SFREQ</span></a> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">L_p</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="n">mx</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">r0</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
            <span class="n">r0</span><span class="p">,</span>
            <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">mx</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">mx</span> <span class="o">-</span> <span class="mi">15</span><span class="p">,</span>
            <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
            <span class="n">extent</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$t$ = </span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> s&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ in m&#39;</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ in m&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.075</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$L_p$ in dB&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">figure_title</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">figure_title</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="beamforming-in-the-time-domain-with-fixed-focus">
<h2>Beamforming in the time domain with fixed focus<a class="headerlink" href="#beamforming-in-the-time-domain-with-fixed-focus" title="Link to this heading">#</a></h2>
<p>Before we compute the moving-focus beamforming maps,
we first perform time-domain beamforming with a fixed focus on a larger grid.
This serves as a baseline to compare against the moving-focus results.</p>
<p>For the fixed-focus case, the grid is placed at <em>z</em> = <code class="docutils literal notranslate"><span class="pre">LZ</span></code>, i.e.,
in the plane of the sources, while the moving-focus grid follows
the trajectory <code class="docutils literal notranslate"><span class="pre">tr0</span></code> at <em>z</em> = 0 (in the plane of the microphones).
It is also wider in the <em>x</em> direction to account for the source
movement during the pass-by.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://www.acoular.org/api_ref/generated/acoular.grids.html#acoular.grids.RectGrid" title="acoular.grids.RectGrid" class="sphx-glr-backref-module-acoular-grids sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rg_fixed</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.grids.html#acoular.grids.RectGrid" title="acoular.grids.RectGrid" class="sphx-glr-backref-module-acoular-grids sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">RectGrid</span></a><span class="p">(</span><span class="n">x_min</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">y_min</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_max</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LZ</span></a><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.fbeamform.html#acoular.fbeamform.SteeringVector" title="acoular.fbeamform.SteeringVector" class="sphx-glr-backref-module-acoular-fbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">st_fixed</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.fbeamform.html#acoular.fbeamform.SteeringVector" title="acoular.fbeamform.SteeringVector" class="sphx-glr-backref-module-acoular-fbeamform sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">SteeringVector</span></a><span class="p">(</span><span class="n">grid</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.grids.html#acoular.grids.RectGrid" title="acoular.grids.RectGrid" class="sphx-glr-backref-module-acoular-grids sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rg_fixed</span></a><span class="p">,</span> <a href="https://www.acoular.org/api_ref/generated/acoular.microphones.html#acoular.microphones.MicGeom" title="acoular.microphones.MicGeom" class="sphx-glr-backref-module-acoular-microphones sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mics</span></a><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.microphones.html#acoular.microphones.MicGeom" title="acoular.microphones.MicGeom" class="sphx-glr-backref-module-acoular-microphones sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mics</span></a><span class="p">)</span>
</pre></div>
</div>
<p>We now connect the processing blocks into a chain that can be executed by Acoular.
The chain is:</p>
<div align="center" class="align-center"><div class="graphviz"><object data="../../_images/graphviz-18622181e0f93ea6379071b86395af352fc52a2e.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph beamforming_pipeline {
SM [label=&quot;SourceMixer&quot;];
FF [label=&quot;FiltFiltOctave&quot;];
BT [label=&quot;BeamformerTimeSq&quot;];
AVG [label=&quot;Average&quot;];
CACHE [label=&quot;Cache&quot;];

SM -&gt; FF -&gt; BT -&gt; AVG -&gt; CACHE;
}</p></object></div>
</div>
<p>We already have the first block, <a class="reference internal" href="../../api_ref/generated/acoular.sources.html#acoular.sources.SourceMixer" title="acoular.sources.SourceMixer"><code class="xref py py-class docutils literal notranslate"><span class="pre">SourceMixer</span></code></a>,
defined as <code class="docutils literal notranslate"><span class="pre">source_mixer</span></code>. The subsequent blocks are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><a class="reference internal" href="../../api_ref/generated/acoular.tprocess.html#acoular.tprocess.FiltFiltOctave" title="acoular.tprocess.FiltFiltOctave"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiltFiltOctave</span></code></a>:
zero-phase third-octave filtering around <code class="docutils literal notranslate"><span class="pre">FREQ</span></code>.</p></li>
<li><p><a class="reference internal" href="../../api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerTimeSq" title="acoular.tbeamform.BeamformerTimeSq"><code class="xref py py-class docutils literal notranslate"><span class="pre">BeamformerTimeSq</span></code></a>:
computes (squared) beamforming.</p></li>
<li><p><a class="reference internal" href="../../api_ref/generated/acoular.process.html#acoular.process.Average" title="acoular.process.Average"><code class="xref py py-class docutils literal notranslate"><span class="pre">Average</span></code></a>:
groups frames into blocks of <code class="docutils literal notranslate"><span class="pre">BLOCK_SIZE</span></code> samples to produce one map per block.</p></li>
<li><p><a class="reference internal" href="../../api_ref/generated/acoular.process.html#acoular.process.Cache" title="acoular.process.Cache"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cache</span></code></a>:
stores the averaged maps so that repeated access is fast and deterministic.</p></li>
</ol>
</div></blockquote>
<p>This processing chain is similar to the one used later for moving-focus beamforming.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://www.acoular.org/api_ref/generated/acoular.tprocess.html#acoular.tprocess.FiltFiltOctave" title="acoular.tprocess.FiltFiltOctave" class="sphx-glr-backref-module-acoular-tprocess sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fi_fixed</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.tprocess.html#acoular.tprocess.FiltFiltOctave" title="acoular.tprocess.FiltFiltOctave" class="sphx-glr-backref-module-acoular-tprocess sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">FiltFiltOctave</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.sources.html#acoular.sources.SourceMixer" title="acoular.sources.SourceMixer" class="sphx-glr-backref-module-acoular-sources sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_mixer</span></a><span class="p">,</span> <span class="n">band</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">FREQ</span></a><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="s1">&#39;Third octave&#39;</span><span class="p">)</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerTimeSq" title="acoular.tbeamform.BeamformerTimeSq" class="sphx-glr-backref-module-acoular-tbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bt_fixed</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerTimeSq" title="acoular.tbeamform.BeamformerTimeSq" class="sphx-glr-backref-module-acoular-tbeamform sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">BeamformerTimeSq</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.tprocess.html#acoular.tprocess.FiltFiltOctave" title="acoular.tprocess.FiltFiltOctave" class="sphx-glr-backref-module-acoular-tprocess sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fi_fixed</span></a><span class="p">,</span> <span class="n">steer</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.fbeamform.html#acoular.fbeamform.SteeringVector" title="acoular.fbeamform.SteeringVector" class="sphx-glr-backref-module-acoular-fbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">st_fixed</span></a><span class="p">,</span> <span class="n">r_diag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Average" title="acoular.process.Average" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">avgt_fixed</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Average" title="acoular.process.Average" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">Average</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerTimeSq" title="acoular.tbeamform.BeamformerTimeSq" class="sphx-glr-backref-module-acoular-tbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bt_fixed</span></a><span class="p">,</span> <span class="n">num_per_average</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">BLOCK_SIZE</span></a><span class="p">)</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Cache" title="acoular.process.Cache" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cacht_fixed</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Cache" title="acoular.process.Cache" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">Cache</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Average" title="acoular.process.Average" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">avgt_fixed</span></a><span class="p">)</span>
</pre></div>
</div>
<p>In the following step, we execute the processing chain and retrieve
a small number of averaged beamforming maps for visualization.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">num</span></code> argument controls how many averaged blocks to return.
Use <code class="docutils literal notranslate"><span class="pre">num=None</span></code> to return all cached blocks, or set <code class="docutils literal notranslate"><span class="pre">num</span></code> to
an integer to limit the number of returned maps.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_fixed</span></a> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Cache.result" title="acoular.process.Cache.result" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-method"><span class="n">cacht_fixed</span><span class="o">.</span><span class="n">result</span></a><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plot_maps</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_fixed</span></a><span class="p">,</span> <a href="https://www.acoular.org/api_ref/generated/acoular.grids.html#acoular.grids.RectGrid" title="acoular.grids.RectGrid" class="sphx-glr-backref-module-acoular-grids sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rg_fixed</span></a><span class="p">,</span> <span class="n">figure_title</span><span class="o">=</span><span class="s1">&#39;Beamforming maps with fixed focus&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_beamforming_with_moving_focus_002.png" srcset="../../_images/sphx_glr_example_beamforming_with_moving_focus_002.png" alt="Beamforming maps with fixed focus, $t$ = 0.00 s, $t$ = 0.15 s, $t$ = 0.30 s" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[(&#39;void_cache.h5&#39;, 1)]
/home/runner/work/acoular/acoular/examples/moving_sources_examples/example_beamforming_with_moving_focus.py:165: UserWarning: This figure was using a layout engine that is incompatible with subplots_adjust and/or tight_layout; not calling subplots_adjust.
  fig.subplots_adjust(wspace=0.075)
</pre></div>
</div>
<p>In the above plot, we observe that the fixed-focus beamforming
maps show the sources as they pass by the microphone array.
However, due to the fixed focus and the averaging, the spatial
resolution is limited, and the sources appear blurred as they
move across the grid.</p>
</section>
<section id="beamforming-in-the-time-domain-with-moving-focus">
<h2>Beamforming in the time domain with moving focus<a class="headerlink" href="#beamforming-in-the-time-domain-with-moving-focus" title="Link to this heading">#</a></h2>
<p>Now for the main part of this example: compute time-domain beamforming maps
along a moving focus trajectory <code class="docutils literal notranslate"><span class="pre">tr0</span></code>. The focus follows the provided
trajectory while beamforming on the grid <code class="docutils literal notranslate"><span class="pre">rg</span></code>.</p>
<p>We now connect the processing blocks into a chain that can be executed by Acoular.
The chain is:</p>
<div align="center" class="align-center"><div class="graphviz"><object data="../../_images/graphviz-57d9bf9c660dbb9485bc9cd87f1ad05e2f105a5a.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph beamforming_pipeline {
SM [label=&quot;SourceMixer&quot;];
FF [label=&quot;FiltFiltOctave&quot;];
BT [label=&quot;BeamformerTimeSqTraj&quot;];
AVG [label=&quot;Average&quot;];
CACHE [label=&quot;Cache&quot;];

SM -&gt; FF -&gt; BT -&gt; AVG -&gt; CACHE;
}</p></object></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://www.acoular.org/api_ref/generated/acoular.tprocess.html#acoular.tprocess.FiltFiltOctave" title="acoular.tprocess.FiltFiltOctave" class="sphx-glr-backref-module-acoular-tprocess sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fi_mov</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.tprocess.html#acoular.tprocess.FiltFiltOctave" title="acoular.tprocess.FiltFiltOctave" class="sphx-glr-backref-module-acoular-tprocess sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">FiltFiltOctave</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.sources.html#acoular.sources.SourceMixer" title="acoular.sources.SourceMixer" class="sphx-glr-backref-module-acoular-sources sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_mixer</span></a><span class="p">,</span> <span class="n">band</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">FREQ</span></a><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="s1">&#39;Third octave&#39;</span><span class="p">)</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerTimeSqTraj" title="acoular.tbeamform.BeamformerTimeSqTraj" class="sphx-glr-backref-module-acoular-tbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bt_mov</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerTimeSqTraj" title="acoular.tbeamform.BeamformerTimeSqTraj" class="sphx-glr-backref-module-acoular-tbeamform sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">BeamformerTimeSqTraj</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.tprocess.html#acoular.tprocess.FiltFiltOctave" title="acoular.tprocess.FiltFiltOctave" class="sphx-glr-backref-module-acoular-tprocess sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fi_mov</span></a><span class="p">,</span> <span class="n">steer</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.fbeamform.html#acoular.fbeamform.SteeringVector" title="acoular.fbeamform.SteeringVector" class="sphx-glr-backref-module-acoular-fbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">st</span></a><span class="p">,</span> <span class="n">trajectory</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.trajectory.html#acoular.trajectory.Trajectory" title="acoular.trajectory.Trajectory" class="sphx-glr-backref-module-acoular-trajectory sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tr0</span></a><span class="p">,</span> <span class="n">r_diag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Average" title="acoular.process.Average" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">avgt_mov</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Average" title="acoular.process.Average" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">Average</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerTimeSqTraj" title="acoular.tbeamform.BeamformerTimeSqTraj" class="sphx-glr-backref-module-acoular-tbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bt_mov</span></a><span class="p">,</span> <span class="n">num_per_average</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">BLOCK_SIZE</span></a><span class="p">)</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Cache" title="acoular.process.Cache" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cacht_mov</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Cache" title="acoular.process.Cache" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">Cache</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Average" title="acoular.process.Average" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">avgt_mov</span></a><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_mov</span></a> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Cache.result" title="acoular.process.Cache.result" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-method"><span class="n">cacht_mov</span><span class="o">.</span><span class="n">result</span></a><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plot_maps</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_mov</span></a><span class="p">,</span> <a href="https://www.acoular.org/api_ref/generated/acoular.grids.html#acoular.grids.RectGrid" title="acoular.grids.RectGrid" class="sphx-glr-backref-module-acoular-grids sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rg</span></a><span class="p">,</span> <span class="n">figure_title</span><span class="o">=</span><span class="s1">&#39;Beamforming maps with moving focus&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_beamforming_with_moving_focus_003.png" srcset="../../_images/sphx_glr_example_beamforming_with_moving_focus_003.png" alt="Beamforming maps with moving focus, $t$ = 0.00 s, $t$ = 0.15 s, $t$ = 0.30 s" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[(&#39;void_cache.h5&#39;, 2)]
</pre></div>
</div>
<p>In the moving-focus beamforming maps, we see that the sources are better
localized as they pass by the microphone array. The moving focus allows
the beamformer to track the sources more effectively, resulting in improved
spatial resolution compared to the fixed-focus case.</p>
</section>
<section id="beamforming-with-deconvolution-cleant-in-the-time-domain-with-moving-focus">
<h2>Beamforming with deconvolution (CLEANT) in the time domain with moving focus<a class="headerlink" href="#beamforming-with-deconvolution-cleant-in-the-time-domain-with-moving-focus" title="Link to this heading">#</a></h2>
<p>Finally, we apply CLEANT-based deconvolution while beamforming along the same
moving focus trajectory. This improves spatial resolution and reduces sidelobes.
The processing chain is similar to the previous one, but we replace
<a class="reference internal" href="../../api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerTimeSqTraj" title="acoular.tbeamform.BeamformerTimeSqTraj"><code class="xref py py-class docutils literal notranslate"><span class="pre">BeamformerTimeSqTraj</span></code></a> with
<a class="reference internal" href="../../api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerCleantSqTraj" title="acoular.tbeamform.BeamformerCleantSqTraj"><code class="xref py py-class docutils literal notranslate"><span class="pre">BeamformerCleantSqTraj</span></code></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://www.acoular.org/api_ref/generated/acoular.tprocess.html#acoular.tprocess.FiltFiltOctave" title="acoular.tprocess.FiltFiltOctave" class="sphx-glr-backref-module-acoular-tprocess sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fi_cleant</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.tprocess.html#acoular.tprocess.FiltFiltOctave" title="acoular.tprocess.FiltFiltOctave" class="sphx-glr-backref-module-acoular-tprocess sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">FiltFiltOctave</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.sources.html#acoular.sources.SourceMixer" title="acoular.sources.SourceMixer" class="sphx-glr-backref-module-acoular-sources sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_mixer</span></a><span class="p">,</span> <span class="n">band</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">FREQ</span></a><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="s1">&#39;Third octave&#39;</span><span class="p">)</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerCleantSqTraj" title="acoular.tbeamform.BeamformerCleantSqTraj" class="sphx-glr-backref-module-acoular-tbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bt_cleant</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerCleantSqTraj" title="acoular.tbeamform.BeamformerCleantSqTraj" class="sphx-glr-backref-module-acoular-tbeamform sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">BeamformerCleantSqTraj</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.tprocess.html#acoular.tprocess.FiltFiltOctave" title="acoular.tprocess.FiltFiltOctave" class="sphx-glr-backref-module-acoular-tprocess sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fi_cleant</span></a><span class="p">,</span> <span class="n">steer</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.fbeamform.html#acoular.fbeamform.SteeringVector" title="acoular.fbeamform.SteeringVector" class="sphx-glr-backref-module-acoular-fbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">st</span></a><span class="p">,</span> <span class="n">trajectory</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.trajectory.html#acoular.trajectory.Trajectory" title="acoular.trajectory.Trajectory" class="sphx-glr-backref-module-acoular-trajectory sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tr0</span></a><span class="p">,</span> <span class="n">conv_amp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Average" title="acoular.process.Average" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">avgt_cleant</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Average" title="acoular.process.Average" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">Average</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.tbeamform.html#acoular.tbeamform.BeamformerCleantSqTraj" title="acoular.tbeamform.BeamformerCleantSqTraj" class="sphx-glr-backref-module-acoular-tbeamform sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bt_cleant</span></a><span class="p">,</span> <span class="n">num_per_average</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">BLOCK_SIZE</span></a><span class="p">)</span>
<a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Cache" title="acoular.process.Cache" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cacht_cleant</span></a> <span class="o">=</span> <a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Cache" title="acoular.process.Cache" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class"><span class="n">ac</span><span class="o">.</span><span class="n">Cache</span></a><span class="p">(</span><span class="n">source</span><span class="o">=</span><a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Average" title="acoular.process.Average" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">avgt_cleant</span></a><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_cleant</span></a> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><a href="https://www.acoular.org/api_ref/generated/acoular.process.html#acoular.process.Cache.result" title="acoular.process.Cache.result" class="sphx-glr-backref-module-acoular-process sphx-glr-backref-type-py-method"><span class="n">cacht_cleant</span><span class="o">.</span><span class="n">result</span></a><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plot_maps</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_cleant</span></a><span class="p">,</span> <a href="https://www.acoular.org/api_ref/generated/acoular.grids.html#acoular.grids.RectGrid" title="acoular.grids.RectGrid" class="sphx-glr-backref-module-acoular-grids sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rg</span></a><span class="p">,</span> <span class="n">figure_title</span><span class="o">=</span><span class="s1">&#39;Beamforming maps with moving focus and CLEANT&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_example_beamforming_with_moving_focus_004.png" srcset="../../_images/sphx_glr_example_beamforming_with_moving_focus_004.png" alt="Beamforming maps with moving focus and CLEANT, $t$ = 0.00 s, $t$ = 0.15 s, $t$ = 0.30 s" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[(&#39;void_cache.h5&#39;, 3)]
</pre></div>
</div>
<p>In the moving-focus beamforming maps with CLEANT, we observe a significant
improvement in spatial resolution compared to both the fixed-focus and
moving-focus without CLEANT cases. The sources are more sharply defined,
and the sidelobes are reduced, demonstrating the effectiveness of CLEANT
deconvolution in enhancing beamforming results for moving sources.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 8.605 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-moving-sources-examples-example-beamforming-with-moving-focus-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/3582492e9136e8596414d6651c83fe48/example_beamforming_with_moving_focus.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">example_beamforming_with_moving_focus.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/7d2cee4a65238bc8dfefabd5ece9c5a1/example_beamforming_with_moving_focus.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">example_beamforming_with_moving_focus.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/07d546251c88626204f721f80eb940ec/example_beamforming_with_moving_focus.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">example_beamforming_with_moving_focus.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Moving sources examples</p>
      </div>
    </a>
    <a class="right-next"
       href="example_rotating_point_source.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Rotating point source</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-example">Setting up the example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beamforming-in-the-time-domain-with-fixed-focus">Beamforming in the time domain with fixed focus</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beamforming-in-the-time-domain-with-moving-focus">Beamforming in the time domain with moving focus</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beamforming-with-deconvolution-cleant-in-the-time-domain-with-moving-focus">Beamforming with deconvolution (CLEANT) in the time domain with moving focus</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/acoular/acoular/edit/master/docs/source/auto_examples/moving_sources_examples/example_beamforming_with_moving_focus.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      ¬© Copyright 2026, Acoular Development Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>